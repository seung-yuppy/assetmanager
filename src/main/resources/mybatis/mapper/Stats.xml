<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.example.assetmanager.dao.StatsDAO">
	<select id="getCategoryData">
		SELECT
		    c.category_name,
		    p.amount
		FROM
		         category c
		    JOIN (
		        SELECT
		            oc.category_id,
		            SUM(price) AS amount
		        FROM
		                 order_content oc
		            JOIN category c ON oc.category_id = c.id
		            JOIN orders   o ON oc.order_id = o.id
		        WHERE
		        		o.is_valid = 1 
		            AND o.order_date &gt;= TO_DATE('2025-01-01', 'YYYY-MM-DD')
		            AND o.order_date &lt; TO_DATE('2026-01-01', 'YYYY-MM-DD')
		        GROUP BY
		            category_id
		    ) p ON c.id = p.category_id
	</select>
</mapper>